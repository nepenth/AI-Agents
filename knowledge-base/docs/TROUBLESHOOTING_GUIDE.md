# JSON Prompt System Troubleshooting Guide\n\n## Overview\n\nThis guide provides solutions to common issues encountered when using the JSON Prompt System, including setup problems, runtime errors, performance issues, and migration challenges.\n\n## Quick Diagnostics\n\n### System Health Check\n\n```python\n# Run this script to check system health\nfrom knowledge_base_agent.prompts_replacement import get_prompt_system_info\nfrom knowledge_base_agent.json_prompt_manager import JsonPromptManager\nfrom knowledge_base_agent.migration_tools import MigrationManager, DeploymentManager\n\nprint(\"üîç JSON Prompt System Health Check\")\nprint(\"=\" * 50)\n\n# 1. Check system configuration\ninfo = get_prompt_system_info()\nprint(f\"\\nüìä System Configuration:\")\nfor key, value in info.items():\n    print(f\"   {key}: {value}\")\n\n# 2. Test basic functionality\ntry:\n    from knowledge_base_agent.prompts_replacement import LLMPrompts\n    chat_prompt = LLMPrompts.get_chat_prompt()\n    print(f\"\\n‚úÖ Basic functionality: Working (prompt length: {len(chat_prompt)})\")\nexcept Exception as e:\n    print(f\"\\n‚ùå Basic functionality: Failed - {e}\")\n\n# 3. Check prompt availability\ntry:\n    manager = JsonPromptManager()\n    available = manager.get_available_prompts()\n    total_prompts = sum(len(prompts) for prompts in available.values())\n    print(f\"\\nüìÅ Available prompts: {total_prompts} prompts in {len(available)} categories\")\nexcept Exception as e:\n    print(f\"\\n‚ùå Prompt loading: Failed - {e}\")\n\n# 4. Check migration status\ntry:\n    migration_manager = MigrationManager()\n    status = migration_manager.get_migration_status()\n    print(f\"\\nüîÑ Migration status: {status['current_system']}\")\nexcept Exception as e:\n    print(f\"\\n‚ùå Migration status: Failed - {e}\")\n\n# 5. Validate deployment\ntry:\n    deployment_manager = DeploymentManager()\n    validation = deployment_manager.validate_deployment()\n    print(f\"\\nüöÄ Deployment: {'‚úÖ Valid' if validation['valid'] else '‚ùå Invalid'}\")\n    if not validation['valid']:\n        for error in validation['errors'][:3]:\n            print(f\"   - {error}\")\nexcept Exception as e:\n    print(f\"\\n‚ùå Deployment validation: Failed - {e}\")\n\nprint(\"\\n\" + \"=\" * 50)\nprint(\"Health check completed. See sections below for specific issues.\")\n```\n\n## Common Issues and Solutions\n\n### 1. Import and Module Loading Issues\n\n#### Issue: `ImportError: cannot import name 'JsonPromptManager'`\n\n**Symptoms:**\n- Cannot import JSON prompt classes\n- Module not found errors\n- Circular import errors\n\n**Solutions:**\n\n1. **Check Python Path**\n   ```python\n   import sys\n   from pathlib import Path\n   \n   # Add project root to Python path\n   project_root = Path(__file__).parent.parent  # Adjust as needed\n   sys.path.insert(0, str(project_root))\n   \n   # Now try importing\n   from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n   ```\n\n2. **Verify File Structure**\n   ```bash\n   # Check that all required files exist\n   ls -la knowledge_base_agent/\n   # Should show:\n   # - json_prompt.py\n   # - json_prompt_manager.py\n   # - prompts_replacement.py\n   # - prompts_json/ directory\n   ```\n\n3. **Check for Syntax Errors**\n   ```bash\n   # Compile all Python files to check for syntax errors\n   python -m py_compile knowledge_base_agent/json_prompt.py\n   python -m py_compile knowledge_base_agent/json_prompt_manager.py\n   python -m py_compile knowledge_base_agent/prompts_replacement.py\n   ```\n\n4. **Resolve Circular Imports**\n   ```python\n   # If you get circular import errors, use lazy imports\n   def get_original_prompts():\n       from . import prompts as original_prompts\n       return original_prompts.LLMPrompts\n   ```\n\n#### Issue: `ModuleNotFoundError: No module named 'knowledge_base_agent'`\n\n**Solutions:**\n\n1. **Install in Development Mode**\n   ```bash\n   # From project root\n   pip install -e .\n   ```\n\n2. **Set PYTHONPATH**\n   ```bash\n   export PYTHONPATH=\"${PYTHONPATH}:/path/to/your/project\"\n   ```\n\n3. **Use Relative Imports**\n   ```python\n   # Instead of absolute imports\n   from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n   \n   # Use relative imports within the package\n   from .json_prompt_manager import JsonPromptManager\n   ```\n\n### 2. Prompt Loading and File Issues\n\n#### Issue: `JsonPromptManagerError: Prompt file not found`\n\n**Symptoms:**\n- Specific prompts cannot be loaded\n- \"File not found\" errors\n- Empty prompt directories\n\n**Solutions:**\n\n1. **Check File Structure**\n   ```bash\n   # Verify prompt directory structure\n   find knowledge_base_agent/prompts_json -name \"*.json\" | head -10\n   \n   # Should show files like:\n   # knowledge_base_agent/prompts_json/standard/chat_standard.json\n   # knowledge_base_agent/prompts_json/reasoning/system_message.json\n   ```\n\n2. **Verify Prompt ID Matches Filename**\n   ```python\n   # Check that prompt_id in file matches filename\n   import json\n   \n   with open('knowledge_base_agent/prompts_json/standard/chat_standard.json') as f:\n       data = json.load(f)\n       print(f\"File: chat_standard.json\")\n       print(f\"Prompt ID: {data['prompt_id']}\")\n       # These should match (without .json extension)\n   ```\n\n3. **Check Permissions**\n   ```bash\n   # Ensure files are readable\n   ls -la knowledge_base_agent/prompts_json/standard/\n   chmod 644 knowledge_base_agent/prompts_json/standard/*.json\n   ```\n\n4. **Debug Available Prompts**\n   ```python\n   from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n   \n   manager = JsonPromptManager()\n   available = manager.get_available_prompts()\n   \n   print(\"Available prompts:\")\n   for model_type, prompt_ids in available.items():\n       print(f\"  {model_type}: {prompt_ids}\")\n   ```\n\n#### Issue: `JSONDecodeError: Expecting property name enclosed in double quotes`\n\n**Symptoms:**\n- JSON parsing errors\n- Invalid JSON syntax\n- Malformed prompt files\n\n**Solutions:**\n\n1. **Validate JSON Syntax**\n   ```bash\n   # Check JSON syntax for all prompt files\n   find knowledge_base_agent/prompts_json -name \"*.json\" -exec python -m json.tool {} \\; > /dev/null\n   ```\n\n2. **Fix Common JSON Issues**\n   ```python\n   # Common issues and fixes:\n   \n   # ‚ùå Trailing commas\n   {\n       \"prompt_id\": \"test\",\n       \"description\": \"test\",  # Remove this comma\n   }\n   \n   # ‚ùå Single quotes\n   {\n       'prompt_id': 'test'  # Use double quotes\n   }\n   \n   # ‚ùå Unescaped quotes in strings\n   {\n       \"content\": \"Say \"hello\" to user\"  # Should be: \"Say \\\"hello\\\" to user\"\n   }\n   \n   # ‚úÖ Correct format\n   {\n       \"prompt_id\": \"test\",\n       \"description\": \"test\",\n       \"content\": \"Say \\\"hello\\\" to user\"\n   }\n   ```\n\n3. **Use JSON Validator**\n   ```python\n   import json\n   from pathlib import Path\n   \n   def validate_json_file(file_path):\n       try:\n           with open(file_path) as f:\n               json.load(f)\n           print(f\"‚úÖ {file_path}: Valid JSON\")\n           return True\n       except json.JSONDecodeError as e:\n           print(f\"‚ùå {file_path}: Invalid JSON - {e}\")\n           return False\n   \n   # Validate all prompt files\n   prompts_dir = Path(\"knowledge_base_agent/prompts_json\")\n   for json_file in prompts_dir.rglob(\"*.json\"):\n       validate_json_file(json_file)\n   ```\n\n### 3. Parameter and Validation Issues\n\n#### Issue: `JsonPromptRenderError: Parameter validation failed`\n\n**Symptoms:**\n- Missing required parameters\n- Invalid parameter types\n- Validation rule violations\n\n**Solutions:**\n\n1. **Check Required Parameters**\n   ```python\n   from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n   \n   manager = JsonPromptManager()\n   prompt = manager.load_prompt(\"categorization_standard\", \"standard\")\n   \n   print(f\"Required parameters: {prompt.required_parameters}\")\n   print(f\"Optional parameters: {prompt.optional_parameters}\")\n   \n   # Check parameter details\n   for param_name in prompt.required_parameters:\n       param_info = prompt.get_parameter_info(param_name)\n       print(f\"  {param_name}: {param_info}\")\n   ```\n\n2. **Validate Parameters Before Rendering**\n   ```python\n   # Always validate parameters first\n   parameters = {\n       \"context_content\": \"Your content here\",\n       \"formatted_existing_categories\": \"category1, category2\",\n       \"is_thread\": False\n   }\n   \n   errors = prompt.validate_parameters(parameters)\n   if errors:\n       print(\"Parameter validation errors:\")\n       for error in errors:\n           print(f\"  - {error}\")\n   else:\n       result = prompt.render(parameters)\n   ```\n\n3. **Fix Common Parameter Issues**\n   ```python\n   # ‚ùå Wrong parameter type\n   parameters = {\n       \"is_thread\": \"false\"  # Should be boolean, not string\n   }\n   \n   # ‚úÖ Correct parameter type\n   parameters = {\n       \"is_thread\": False  # Boolean value\n   }\n   \n   # ‚ùå Missing required parameter\n   parameters = {\n       \"context_content\": \"content\"\n       # Missing \"formatted_existing_categories\"\n   }\n   \n   # ‚úÖ All required parameters\n   parameters = {\n       \"context_content\": \"content\",\n       \"formatted_existing_categories\": \"cat1, cat2\",\n       \"is_thread\": False\n   }\n   ```\n\n#### Issue: Template rendering errors\n\n**Symptoms:**\n- Jinja2 template errors\n- Undefined variables\n- Template syntax issues\n\n**Solutions:**\n\n1. **Check Template Syntax**\n   ```python\n   # Debug template content\n   prompt = manager.load_prompt(\"your_prompt\", \"standard\")\n   template_content = prompt.data[\"template\"][\"content\"]\n   print(f\"Template: {template_content}\")\n   \n   # Check for common issues:\n   # - Unmatched braces: {{ variable }\n   # - Undefined variables: {{ undefined_var }}\n   # - Invalid syntax: {% if condition %} without {% endif %}\n   ```\n\n2. **Test Template Variables**\n   ```python\n   import re\n   \n   # Extract variables from template\n   template_content = prompt.data[\"template\"][\"content\"]\n   variables = re.findall(r'{{\\s*(\\w+)\\s*}}', template_content)\n   print(f\"Template variables: {variables}\")\n   \n   # Ensure all variables have corresponding parameters\n   for var in variables:\n       if var not in prompt.all_parameters:\n           print(f\"‚ö†Ô∏è  Variable '{var}' not defined in parameters\")\n   ```\n\n3. **Use Safe Rendering**\n   ```python\n   # Render with error handling\n   try:\n       result = prompt.render(parameters)\n       print(f\"‚úÖ Rendered successfully: {len(result.content)} characters\")\n   except Exception as e:\n       print(f\"‚ùå Rendering failed: {e}\")\n       \n       # Try with minimal parameters\n       minimal_params = {param: \"test\" for param in prompt.required_parameters}\n       try:\n           result = prompt.render(minimal_params)\n           print(\"‚úÖ Minimal rendering works - check your parameter values\")\n       except Exception as e2:\n           print(f\"‚ùå Even minimal rendering fails: {e2}\")\n   ```\n\n### 4. Environment and Configuration Issues\n\n#### Issue: JSON prompts not being used despite configuration\n\n**Symptoms:**\n- System reports using original prompts\n- Environment variable seems ignored\n- Inconsistent behavior\n\n**Solutions:**\n\n1. **Check Environment Variable**\n   ```python\n   import os\n   \n   print(f\"USE_JSON_PROMPTS environment variable: {os.getenv('USE_JSON_PROMPTS')}\")\n   \n   # Set explicitly\n   os.environ['USE_JSON_PROMPTS'] = 'true'\n   \n   # Clear cached managers\n   from knowledge_base_agent.prompts_replacement import use_json_prompts\n   use_json_prompts(True)  # This clears caches\n   ```\n\n2. **Check .env File**\n   ```bash\n   # Check if .env file exists and contains the setting\n   cat .env | grep USE_JSON_PROMPTS\n   \n   # If not present, add it\n   echo \"USE_JSON_PROMPTS=true\" >> .env\n   ```\n\n3. **Force System Refresh**\n   ```python\n   from knowledge_base_agent.prompts_replacement import (\n       use_json_prompts, is_using_json_prompts, get_prompt_system_info\n   )\n   \n   # Force refresh\n   use_json_prompts(False)  # Clear caches\n   use_json_prompts(True)   # Re-enable with fresh state\n   \n   # Verify\n   print(f\"Using JSON prompts: {is_using_json_prompts()}\")\n   info = get_prompt_system_info()\n   print(f\"System info: {info}\")\n   ```\n\n4. **Debug Manager Initialization**\n   ```python\n   # Check if JsonPromptManager initializes correctly\n   try:\n       from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n       manager = JsonPromptManager()\n       print(\"‚úÖ JsonPromptManager initialized successfully\")\n       \n       available = manager.get_available_prompts()\n       print(f\"Available prompts: {len(available)} types\")\n       \n   except Exception as e:\n       print(f\"‚ùå JsonPromptManager initialization failed: {e}\")\n       print(\"System will fall back to original prompts\")\n   ```\n\n### 5. Performance Issues\n\n#### Issue: Slow prompt rendering\n\n**Symptoms:**\n- Long response times\n- High CPU usage\n- Memory consumption\n\n**Solutions:**\n\n1. **Check Cache Performance**\n   ```python\n   from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n   \n   manager = JsonPromptManager()\n   \n   # Load a prompt multiple times\n   import time\n   \n   # First load (cache miss)\n   start = time.time()\n   prompt1 = manager.load_prompt(\"chat_standard\", \"standard\")\n   first_load_time = time.time() - start\n   \n   # Second load (cache hit)\n   start = time.time()\n   prompt2 = manager.load_prompt(\"chat_standard\", \"standard\")\n   second_load_time = time.time() - start\n   \n   print(f\"First load: {first_load_time:.4f}s\")\n   print(f\"Second load: {second_load_time:.4f}s\")\n   print(f\"Speedup: {first_load_time / second_load_time:.1f}x\")\n   \n   # Check cache stats\n   stats = manager.get_cache_stats()\n   print(f\"Cache hit rate: {stats['hit_rate']:.2%}\")\n   ```\n\n2. **Optimize Template Complexity**\n   ```python\n   # Check template complexity\n   prompt = manager.load_prompt(\"your_prompt\", \"standard\")\n   template_content = prompt.data[\"template\"][\"content\"]\n   \n   print(f\"Template length: {len(template_content)} characters\")\n   \n   # Count template variables\n   import re\n   variables = re.findall(r'{{.*?}}', template_content)\n   print(f\"Template variables: {len(variables)}\")\n   \n   # Check for complex logic\n   if_statements = re.findall(r'{%.*?if.*?%}', template_content)\n   print(f\"Conditional statements: {len(if_statements)}\")\n   \n   if len(variables) > 20 or len(if_statements) > 5:\n       print(\"‚ö†Ô∏è  Complex template may impact performance\")\n   ```\n\n3. **Preload Frequently Used Prompts**\n   ```python\n   # Preload prompts at application startup\n   manager = JsonPromptManager()\n   \n   # Preload all standard prompts\n   results = manager.preload_prompts([\"standard\"])\n   print(f\"Preloaded {results['loaded']} prompts\")\n   \n   if results['errors'] > 0:\n       print(f\"Failed to preload {results['errors']} prompts\")\n       for detail in results['details']:\n           if not detail['success']:\n               print(f\"  - {detail['prompt_id']}: {detail['error']}\")\n   ```\n\n4. **Monitor Memory Usage**\n   ```python\n   import psutil\n   import os\n   \n   process = psutil.Process(os.getpid())\n   \n   # Before loading prompts\n   memory_before = process.memory_info().rss / 1024 / 1024\n   \n   # Load many prompts\n   manager = JsonPromptManager()\n   available = manager.get_available_prompts()\n   \n   for model_type, prompt_ids in available.items():\n       for prompt_id in prompt_ids[:5]:  # Load first 5 of each type\n           manager.load_prompt(prompt_id, model_type)\n   \n   # After loading prompts\n   memory_after = process.memory_info().rss / 1024 / 1024\n   \n   print(f\"Memory usage: {memory_before:.2f} MB -> {memory_after:.2f} MB\")\n   print(f\"Memory per prompt: {(memory_after - memory_before) / 10:.2f} MB\")\n   \n   if memory_after - memory_before > 100:  # More than 100MB\n       print(\"‚ö†Ô∏è  High memory usage detected\")\n       \n       # Clear cache to free memory\n       manager.clear_cache()\n       print(\"Cache cleared to free memory\")\n   ```\n\n### 6. Migration Issues\n\n#### Issue: Migration validation fails\n\n**Symptoms:**\n- Migration process stops with validation errors\n- Prompts fail validation checks\n- Inconsistent prompt behavior\n\n**Solutions:**\n\n1. **Run Detailed Validation**\n   ```python\n   from knowledge_base_agent.migration_tools import MigrationManager\n   \n   migration_manager = MigrationManager()\n   results = migration_manager.validate_json_prompts()\n   \n   print(f\"Validation results:\")\n   print(f\"  Total prompts: {results['total_prompts']}\")\n   print(f\"  Valid prompts: {results['valid_prompts']}\")\n   print(f\"  Invalid prompts: {results['invalid_prompts']}\")\n   \n   if results['errors']:\n       print(\"\\nValidation errors:\")\n       for error in results['errors']:\n           print(f\"  - {error}\")\n   ```\n\n2. **Fix Individual Prompt Issues**\n   ```python\n   from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n   \n   manager = JsonPromptManager()\n   available = manager.get_available_prompts()\n   \n   # Validate each prompt individually\n   for model_type, prompt_ids in available.items():\n       for prompt_id in prompt_ids:\n           try:\n               result = manager.validate_prompt(prompt_id, model_type)\n               if not result['valid']:\n                   print(f\"‚ùå {model_type}:{prompt_id}\")\n                   for error in result['errors']:\n                       print(f\"    - {error}\")\n               else:\n                   print(f\"‚úÖ {model_type}:{prompt_id}\")\n           except Exception as e:\n               print(f\"‚ùå {model_type}:{prompt_id} - Exception: {e}\")\n   ```\n\n3. **Force Migration with Warnings**\n   ```python\n   # If validation fails but you want to proceed\n   success = migration_manager.migrate_to_json(force=True)\n   \n   if success:\n       print(\"‚úÖ Migration completed with force flag\")\n       print(\"‚ö†Ô∏è  Some prompts may have validation issues\")\n       print(\"Please review and fix validation errors\")\n   else:\n       print(\"‚ùå Migration failed even with force flag\")\n   ```\n\n#### Issue: Rollback fails\n\n**Symptoms:**\n- Cannot rollback to original system\n- Backup not available\n- System stuck in inconsistent state\n\n**Solutions:**\n\n1. **Check Rollback Availability**\n   ```python\n   from knowledge_base_agent.migration_tools import MigrationManager\n   \n   migration_manager = MigrationManager()\n   status = migration_manager.get_migration_status()\n   \n   print(f\"Current system: {status['current_system']}\")\n   print(f\"Rollback available: {status['rollback_available']}\")\n   print(f\"Available backups: {len(status['available_backups'])}\")\n   \n   if not status['rollback_available']:\n       print(\"‚ö†Ô∏è  No automatic rollback available\")\n       print(\"Available backups:\")\n       \n       backups = migration_manager.list_backups()\n       for backup in backups:\n           print(f\"  - {backup['name']}: {backup['description']}\")\n   ```\n\n2. **Manual Rollback**\n   ```python\n   # Manually set environment to use original prompts\n   import os\n   os.environ['USE_JSON_PROMPTS'] = 'false'\n   \n   # Clear cached managers\n   from knowledge_base_agent.prompts_replacement import use_json_prompts\n   use_json_prompts(False)\n   \n   # Test original system\n   from knowledge_base_agent.prompts_replacement import LLMPrompts, get_prompt_system_info\n   \n   info = get_prompt_system_info()\n   print(f\"Using JSON prompts: {info['using_json_prompts']}\")\n   \n   # Test functionality\n   chat_prompt = LLMPrompts.get_chat_prompt()\n   print(f\"‚úÖ Original system working: {len(chat_prompt)} characters\")\n   ```\n\n3. **Reset Migration State**\n   ```python\n   # If migration state is corrupted, reset it\n   migration_manager = MigrationManager()\n   \n   # Backup current state file\n   import shutil\n   state_file = migration_manager.state_file\n   if state_file.exists():\n       backup_file = state_file.with_suffix('.backup')\n       shutil.copy2(state_file, backup_file)\n       print(f\"Backed up state file to {backup_file}\")\n   \n   # Reset state\n   migration_manager.state = {\n       \"migrations\": [],\n       \"current_system\": \"original\",\n       \"last_migration\": None,\n       \"rollback_available\": False\n   }\n   migration_manager.save_migration_state()\n   print(\"Migration state reset to original\")\n   ```\n\n### 7. Development and Debugging Issues\n\n#### Issue: Changes to prompts not reflected\n\n**Symptoms:**\n- Prompt modifications don't take effect\n- Old content still being used\n- Caching issues\n\n**Solutions:**\n\n1. **Clear Prompt Cache**\n   ```python\n   from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n   \n   manager = JsonPromptManager()\n   \n   # Clear all cached prompts\n   manager.clear_cache()\n   print(\"Prompt cache cleared\")\n   \n   # Verify cache is empty\n   stats = manager.get_cache_stats()\n   print(f\"Cached prompts: {stats['cached_prompts']}\")\n   ```\n\n2. **Force Reload Specific Prompt**\n   ```python\n   # Force reload a specific prompt\n   prompt = manager.load_prompt(\"your_prompt\", \"standard\", force_reload=True)\n   print(f\"Prompt reloaded: {prompt.prompt_id}\")\n   ```\n\n3. **Check File Modification Times**\n   ```python\n   from pathlib import Path\n   import os\n   \n   prompt_file = Path(\"knowledge_base_agent/prompts_json/standard/your_prompt.json\")\n   \n   if prompt_file.exists():\n       mtime = os.path.getmtime(prompt_file)\n       print(f\"File last modified: {mtime}\")\n       \n       # Check if file was recently modified\n       import time\n       current_time = time.time()\n       if current_time - mtime < 300:  # Modified in last 5 minutes\n           print(\"‚úÖ File was recently modified\")\n       else:\n           print(\"‚ö†Ô∏è  File hasn't been modified recently\")\n   else:\n       print(\"‚ùå Prompt file not found\")\n   ```\n\n4. **Restart Application**\n   ```python\n   # Sometimes a full restart is needed\n   print(\"If changes still don't appear, try:\")\n   print(\"1. Restart your Python interpreter\")\n   print(\"2. Restart your application server\")\n   print(\"3. Clear Python __pycache__ directories\")\n   \n   # Clear __pycache__ programmatically\n   import shutil\n   from pathlib import Path\n   \n   for pycache_dir in Path(\".\").rglob(\"__pycache__\"):\n       shutil.rmtree(pycache_dir)\n       print(f\"Removed {pycache_dir}\")\n   ```\n\n## Advanced Debugging\n\n### Enable Debug Logging\n\n```python\nimport logging\n\n# Enable debug logging for JSON prompt system\nlogging.basicConfig(level=logging.DEBUG)\nlogger = logging.getLogger('knowledge_base_agent')\nlogger.setLevel(logging.DEBUG)\n\n# Create console handler with debug level\nhandler = logging.StreamHandler()\nhandler.setLevel(logging.DEBUG)\nformatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')\nhandler.setFormatter(formatter)\nlogger.addHandler(handler)\n\n# Now run your code - you'll see detailed debug output\nfrom knowledge_base_agent.json_prompt_manager import JsonPromptManager\nmanager = JsonPromptManager()\n```\n\n### Create Minimal Test Case\n\n```python\n# Create a minimal test case to isolate issues\ndef minimal_test():\n    \"\"\"Minimal test to isolate prompt system issues.\"\"\"\n    print(\"üß™ Minimal Test Case\")\n    print(\"=\" * 30)\n    \n    try:\n        # Step 1: Import\n        print(\"1. Importing modules...\")\n        from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n        print(\"   ‚úÖ Import successful\")\n        \n        # Step 2: Initialize\n        print(\"2. Initializing manager...\")\n        manager = JsonPromptManager()\n        print(\"   ‚úÖ Manager initialized\")\n        \n        # Step 3: List prompts\n        print(\"3. Getting available prompts...\")\n        available = manager.get_available_prompts()\n        print(f\"   ‚úÖ Found {sum(len(p) for p in available.values())} prompts\")\n        \n        # Step 4: Load a prompt\n        print(\"4. Loading a prompt...\")\n        if 'standard' in available and available['standard']:\n            prompt_id = available['standard'][0]\n            prompt = manager.load_prompt(prompt_id, 'standard')\n            print(f\"   ‚úÖ Loaded prompt: {prompt_id}\")\n            \n            # Step 5: Render prompt\n            print(\"5. Rendering prompt...\")\n            # Use minimal parameters\n            params = {param: \"test\" for param in prompt.required_parameters}\n            result = prompt.render(params)\n            print(f\"   ‚úÖ Rendered: {len(result.content)} characters\")\n        else:\n            print(\"   ‚ö†Ô∏è  No standard prompts available\")\n        \n        print(\"\\n‚úÖ All tests passed!\")\n        return True\n        \n    except Exception as e:\n        print(f\"\\n‚ùå Test failed at step: {e}\")\n        import traceback\n        traceback.print_exc()\n        return False\n\n# Run minimal test\nminimal_test()\n```\n\n### Performance Profiling\n\n```python\nimport cProfile\nimport pstats\nfrom io import StringIO\n\ndef profile_prompt_operations():\n    \"\"\"Profile prompt operations to identify bottlenecks.\"\"\"\n    \n    def test_operations():\n        from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n        \n        manager = JsonPromptManager()\n        \n        # Load multiple prompts\n        available = manager.get_available_prompts()\n        for model_type, prompt_ids in available.items():\n            for prompt_id in prompt_ids[:3]:  # First 3 of each type\n                prompt = manager.load_prompt(prompt_id, model_type)\n                \n                # Render with minimal parameters\n                params = {param: \"test\" for param in prompt.required_parameters}\n                result = prompt.render(params)\n    \n    # Profile the operations\n    profiler = cProfile.Profile()\n    profiler.enable()\n    \n    test_operations()\n    \n    profiler.disable()\n    \n    # Print results\n    s = StringIO()\n    ps = pstats.Stats(profiler, stream=s).sort_stats('cumulative')\n    ps.print_stats(20)  # Top 20 functions\n    \n    print(\"Performance Profile:\")\n    print(s.getvalue())\n\n# Run profiling\nprofile_prompt_operations()\n```\n\n## Getting Help\n\nIf you're still experiencing issues after trying these solutions:\n\n1. **Run the Health Check Script** at the top of this guide\n2. **Create a Minimal Test Case** to isolate the problem\n3. **Enable Debug Logging** to get detailed error information\n4. **Check the Test Suite** to see if similar issues are covered\n5. **Review the Documentation** for additional configuration options\n\n### Useful Commands for Support\n\n```bash\n# System information\npython --version\npip list | grep -E \"jinja2|pathlib|typing\"\n\n# File structure\nfind knowledge_base_agent -name \"*.py\" | grep -E \"json_prompt|prompts_replacement\"\nfind knowledge_base_agent/prompts_json -name \"*.json\" | wc -l\n\n# Test basic functionality\npython -c \"from knowledge_base_agent.prompts_replacement import get_prompt_system_info; print(get_prompt_system_info())\"\n\n# Check for syntax errors\npython -m py_compile knowledge_base_agent/json_prompt.py\npython -m py_compile knowledge_base_agent/json_prompt_manager.py\n```\n\n### Common Environment Information\n\n```python\n# Collect environment information for support\nimport sys\nimport os\nfrom pathlib import Path\n\nprint(\"Environment Information:\")\nprint(f\"Python version: {sys.version}\")\nprint(f\"Platform: {sys.platform}\")\nprint(f\"Current directory: {os.getcwd()}\")\nprint(f\"Python path: {sys.path[:3]}...\")  # First 3 entries\nprint(f\"USE_JSON_PROMPTS: {os.getenv('USE_JSON_PROMPTS', 'not set')}\")\n\n# Check file structure\nproject_root = Path(\".\")\nprint(f\"\\nFile structure:\")\nprint(f\"  knowledge_base_agent/ exists: {(project_root / 'knowledge_base_agent').exists()}\")\nprint(f\"  prompts_json/ exists: {(project_root / 'knowledge_base_agent' / 'prompts_json').exists()}\")\nprint(f\"  json_prompt.py exists: {(project_root / 'knowledge_base_agent' / 'json_prompt.py').exists()}\")\n\n# Try basic import\ntry:\n    from knowledge_base_agent.json_prompt_manager import JsonPromptManager\n    print(f\"  JsonPromptManager import: ‚úÖ Success\")\nexcept Exception as e:\n    print(f\"  JsonPromptManager import: ‚ùå Failed - {e}\")\n```\n\nThis troubleshooting guide covers the most common issues encountered with the JSON Prompt System. Most problems can be resolved by following the diagnostic steps and solutions provided above.\n"