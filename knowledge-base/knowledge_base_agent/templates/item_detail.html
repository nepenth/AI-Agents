{% extends "base.html" %}

{% block title %}{{ item.display_title or item.title }} - Knowledge Base{% endblock %}

{% block content %}
<div class="container-fluid mt-3">
    <div class="row">
        <div class="col-lg-3 col-md-4 d-none d-md-block" id="sidebar-container">
            {% include 'sidebar_content.html' %}
        </div>
        <div class="col-lg-9 col-md-8">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Home</a></li>
                    {% if item.main_category %}
                        <li class="breadcrumb-item">{{ item.main_category.replace('_', ' ') | title }}</li> {# TODO: Link to category view #}
                    {% endif %}
                    {% if item.sub_category %}
                        <li class="breadcrumb-item">{{ item.sub_category.replace('_', ' ') | title }}</li> {# TODO: Link to subcat view #}
                    {% endif %}
                    <li class="breadcrumb-item active" aria-current="page">{{ item.display_title or item.title }}</li>
                </ol>
            </nav>
            <hr>
            
            <h1>{{ item.display_title or item.title }}</h1>
            {% if item.description %}
                <p class="lead">{{ item.description }}</p>
            {% endif %}
            <p class="text-muted">
                <small>
                    {% if item.source_url %}Source: <a href="{{ item.source_url }}" target="_blank" rel="noopener noreferrer">{{ item.source_url}}</a><br>{% endif %}
                    Last Updated: {{ item.last_updated.strftime('%Y-%m-%d %H:%M:%S') }} UTC
                </small>
            </p>
            <hr>

            <div class="kb-content">
                {{ content | safe }}
            </div>
            
            {% if media_list and media_list | length > 0 %}
                <hr>
                <h5>Associated Media Files:</h5>
                <ul>
                    {% for media_file_rel_path in media_list %}
                    <li><a href="{{ url_for('serve_kb_media', path=media_file_rel_path) }}" target="_blank" rel="noopener noreferrer">{{ media_file_rel_path.split('/')[-1] }}</a></li>
                    {% endfor %}
                </ul>
            {% endif %}
            <hr>
            <a href="{{ url_for('index') }}" class="btn btn-secondary mt-3 mb-3">Back to Home</a>
        </div>
    </div>
</div>
{% endblock %} 