# =============================================================================
# AI Agent Backend Configuration
# =============================================================================

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
# PostgreSQL database connection URL with async driver
DATABASE_URL=postgresql+asyncpg://aiagent_user:aiagent_password@localhost:5433/aiagent

# Enable SQL query logging (set to true for debugging, false for production)
DATABASE_ECHO=false

# Database connection pool settings
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=30
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# -----------------------------------------------------------------------------
# Redis Configuration
# -----------------------------------------------------------------------------
# Redis connection URL for caching and session storage
REDIS_URL=redis://localhost:6380

# Redis connection pool settings
REDIS_MAX_CONNECTIONS=50
REDIS_RETRY_ON_TIMEOUT=true

# -----------------------------------------------------------------------------
# Celery Configuration (Background Tasks)
# -----------------------------------------------------------------------------
# Celery broker URL (Redis)
CELERY_BROKER_URL=redis://localhost:6380/0

# Celery result backend (Redis)
CELERY_RESULT_BACKEND=redis://localhost:6380/0

# Celery worker settings
CELERY_WORKER_CONCURRENCY=4
CELERY_TASK_ALWAYS_EAGER=false
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=UTC

# Task routing and queues
CELERY_DEFAULT_QUEUE=default
CELERY_AI_PROCESSING_QUEUE=ai_processing
CELERY_CONTENT_PROCESSING_QUEUE=content_processing
CELERY_MIGRATION_QUEUE=migration

# -----------------------------------------------------------------------------
# Application Configuration
# -----------------------------------------------------------------------------
# Application secret key (MUST be changed in production - minimum 32 characters)
SECRET_KEY=your-secret-key-change-in-production-minimum-32-chars

# Environment mode
ENVIRONMENT=development
DEBUG=true

# Logging configuration
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_TO_FILE=false
LOG_FILE_PATH=./logs/app.log
LOG_MAX_FILE_SIZE=10485760
LOG_BACKUP_COUNT=5

# Application server settings
HOST=0.0.0.0
PORT=8000
WORKERS=1
RELOAD=true

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------
# JWT Token settings
JWT_SECRET_KEY=your-jwt-secret-key-change-in-production-minimum-32-chars
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# Password security requirements
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true

# API Key settings
API_KEY_EXPIRE_DAYS=365

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST_SIZE=10

# Session security
SESSION_COOKIE_SECURE=false
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=strict
SESSION_EXPIRE_HOURS=24

# HTTPS enforcement (set to true in production)
FORCE_HTTPS=false

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Allowed origins for CORS (comma-separated list or JSON array)
ALLOWED_ORIGINS=["http://localhost:3000", "http://localhost:5173", "http://127.0.0.1:3000"]
ALLOW_CREDENTIALS=true
ALLOWED_METHODS=["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"]
ALLOWED_HEADERS=["*"]

# -----------------------------------------------------------------------------
# AI Backend Configuration
# -----------------------------------------------------------------------------
# Default AI provider (ollama, localai, openai_compatible)
AI_PROVIDER=ollama
DEFAULT_AI_BACKEND=ollama

# Ollama Configuration
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama2:7b
OLLAMA_EMBEDDING_MODEL=nomic-embed-text
OLLAMA_TIMEOUT=300
OLLAMA_MAX_RETRIES=3

# LocalAI Configuration
LOCALAI_BASE_URL=http://localhost:8080
LOCALAI_MODEL=gpt-3.5-turbo
LOCALAI_EMBEDDING_MODEL=text-embedding-ada-002
LOCALAI_TIMEOUT=300
LOCALAI_MAX_RETRIES=3

# Backend and core
DATA_DIR=./data
MEDIA_DIR=./data/media
KNOWLEDGE_BASE_DIR=./data/knowledge_base

# Optional per-phase defaults (can also be configured via API)
PHASE_MODEL_VISION_BACKEND=ollama
PHASE_MODEL_VISION_MODEL=qwen2.5vl:32b

PHASE_MODEL_KB_GENERATION_BACKEND=ollama
PHASE_MODEL_KB_GENERATION_MODEL=qwen3:30b-a3b-instruct-2507-q8_0

PHASE_MODEL_SYNTHESIS_BACKEND=ollama
PHASE_MODEL_SYNTHESIS_MODEL=qwen3:30b-a3b-instruct-2507-q8_0

PHASE_MODEL_CHAT_BACKEND=ollama
PHASE_MODEL_CHAT_MODEL=gpt-oss:20b

PHASE_MODEL_EMBEDDINGS_BACKEND=ollama
PHASE_MODEL_EMBEDDINGS_MODEL=snowflake-arctic-embed2

# OpenAI Compatible Configuration
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-3.5-turbo
OPENAI_EMBEDDING_MODEL=text-embedding-ada-002
OPENAI_TIMEOUT=300
OPENAI_MAX_RETRIES=3

# -----------------------------------------------------------------------------
# Twitter/X API Configuration
# -----------------------------------------------------------------------------
# Twitter/X API v2 credentials for bookmark fetching
X_API_KEY=your-twitter-api-key
X_API_SECRET=your-twitter-api-secret
X_BEARER_TOKEN=your-twitter-bearer-token

# Twitter/X bookmark collection URL or user bookmark endpoint
X_BOOKMARK_URL=https://api.twitter.com/2/users/{user_id}/bookmarks

# Twitter/X API settings
X_API_TIMEOUT=30
X_API_MAX_RETRIES=3
X_API_RATE_LIMIT_WINDOW=900
X_API_RATE_LIMIT_REQUESTS=75

# Thread detection settings
X_THREAD_DETECTION_ENABLED=true
X_THREAD_MAX_DEPTH=50
X_THREAD_TIMEOUT=60

# Media caching settings
X_MEDIA_CACHE_ENABLED=true
X_MEDIA_MAX_SIZE=10485760
X_MEDIA_ALLOWED_TYPES=["image/jpeg", "image/png", "image/gif", "video/mp4", "video/quicktime"]

# AI Processing settings
AI_MAX_TOKENS=2000
AI_TEMPERATURE=0.7
AI_TOP_P=1.0
AI_FREQUENCY_PENALTY=0.0
AI_PRESENCE_PENALTY=0.0

# Content processing settings
AI_CHUNK_SIZE=1000
AI_CHUNK_OVERLAP=200
AI_MAX_CHUNKS_PER_ITEM=50

# -----------------------------------------------------------------------------
# Vector Search Configuration
# -----------------------------------------------------------------------------
# Vector database settings (using pgvector extension)
VECTOR_DIMENSION=384
VECTOR_SIMILARITY_THRESHOLD=0.7
VECTOR_MAX_RESULTS=100

# Embedding cache settings
EMBEDDING_CACHE_TTL=86400
EMBEDDING_BATCH_SIZE=10

# Search configuration
SEARCH_DEFAULT_LIMIT=20
SEARCH_MAX_LIMIT=100
SEARCH_ENABLE_HYBRID=true

# -----------------------------------------------------------------------------
# File Storage Configuration
# -----------------------------------------------------------------------------
# Base data directory
DATA_DIR=./data

# Media file storage
MEDIA_DIR=./data/media
MEDIA_MAX_FILE_SIZE=10485760
MEDIA_ALLOWED_EXTENSIONS=.txt,.md,.json,.csv,.pdf,.jpg,.jpeg,.png,.gif

# Knowledge base storage
KNOWLEDGE_BASE_DIR=./data/knowledge_base

# Upload settings
UPLOAD_DIR=./data/uploads
UPLOAD_MAX_FILE_SIZE=10485760
UPLOAD_ALLOWED_MIME_TYPES=text/plain,text/markdown,application/json,text/csv,application/pdf

# Backup and migration settings
BACKUP_DIR=./data/backups
MIGRATION_BACKUP_DIR=./data/migration_backups

# -----------------------------------------------------------------------------
# WebSocket Configuration
# -----------------------------------------------------------------------------
# WebSocket settings
WEBSOCKET_ENABLED=true
WEBSOCKET_HEARTBEAT_INTERVAL=30
WEBSOCKET_MAX_CONNECTIONS=1000
WEBSOCKET_MESSAGE_MAX_SIZE=1048576

# PubSub settings
PUBSUB_ENABLED=true
PUBSUB_CHANNEL_PREFIX=aiagent
PUBSUB_MAX_RETRIES=3

# -----------------------------------------------------------------------------
# Monitoring and Observability
# -----------------------------------------------------------------------------
# Health check settings
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_TIMEOUT=30

# Metrics collection
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Performance monitoring
PERFORMANCE_MONITORING_ENABLED=true
SLOW_QUERY_THRESHOLD=1.0
SLOW_REQUEST_THRESHOLD=5.0

# Error tracking
ERROR_TRACKING_ENABLED=true
ERROR_TRACKING_DSN=

# -----------------------------------------------------------------------------
# Content Processing Configuration
# -----------------------------------------------------------------------------
# Content analysis settings
CONTENT_MIN_LENGTH=10
CONTENT_MAX_LENGTH=1000000
CONTENT_AUTO_CATEGORIZE=true
CONTENT_AUTO_SUMMARIZE=true
CONTENT_AUTO_EXTRACT_ENTITIES=true

# Knowledge extraction settings
KNOWLEDGE_MIN_CONTENT_LENGTH=500
KNOWLEDGE_AUTO_GENERATE=true
KNOWLEDGE_SIMILARITY_THRESHOLD=0.8

# Synthesis generation settings
SYNTHESIS_ENABLED=true
SYNTHESIS_MIN_SOURCES=3
SYNTHESIS_MAX_SOURCES=20

# -----------------------------------------------------------------------------
# Chat Configuration
# -----------------------------------------------------------------------------
# Chat system settings
CHAT_ENABLED=true
CHAT_MAX_MESSAGE_LENGTH=10000
CHAT_CONVERSATION_MEMORY_LIMIT=20
CHAT_MAX_CONTEXT_LENGTH=4000
CHAT_DEFAULT_TEMPERATURE=0.7

# Chat streaming settings
CHAT_STREAMING_ENABLED=true
CHAT_STREAMING_CHUNK_SIZE=50

# -----------------------------------------------------------------------------
# Agent Control Configuration
# -----------------------------------------------------------------------------
# Agent task settings
AGENT_MAX_CONCURRENT_TASKS=10
AGENT_TASK_TIMEOUT=3600
AGENT_TASK_RETRY_COUNT=3
AGENT_TASK_HISTORY_LIMIT=1000

# Agent monitoring
AGENT_MONITORING_ENABLED=true
AGENT_METRICS_COLLECTION=true
AGENT_HEALTH_CHECK_INTERVAL=60

# -----------------------------------------------------------------------------
# Migration Configuration
# -----------------------------------------------------------------------------
# Migration settings
MIGRATION_ENABLED=true
MIGRATION_BATCH_SIZE=100
MIGRATION_VALIDATE_DATA=true
MIGRATION_CREATE_BACKUPS=true
MIGRATION_PRESERVE_TIMESTAMPS=true

# Migration safety settings
MIGRATION_MAX_FILE_SIZE=10485760
MIGRATION_ALLOWED_FORMATS=json,md,txt,csv
MIGRATION_TIMEOUT=7200

# -----------------------------------------------------------------------------
# Testing Configuration
# -----------------------------------------------------------------------------
# Test database (only used in test environment)
TEST_DATABASE_URL=postgresql+asyncpg://test:test@localhost/test_ai_agent

# Test settings
TEST_AI_PROVIDER=mock
TEST_REDIS_URL=redis://localhost:6379/1
TEST_USE_FAKE_REDIS=true
TEST_CELERY_ALWAYS_EAGER=true

# -----------------------------------------------------------------------------
# Development Configuration
# -----------------------------------------------------------------------------
# Development tools
DEV_RELOAD=true
DEV_DEBUG_TOOLBAR=false
DEV_PROFILING=false

# API documentation
API_DOCS_ENABLED=true
API_DOCS_URL=/docs
API_REDOC_URL=/redoc

# Development database seeding
DEV_SEED_DATABASE=false
DEV_SEED_SAMPLE_DATA=false

# -----------------------------------------------------------------------------
# Git Sync Configuration
# -----------------------------------------------------------------------------
# Git repository settings
GIT_REPO_URL=https://github.com/yourusername/your-repo.git
GIT_BRANCH=main
GIT_USERNAME=your-git-username
GIT_PASSWORD=your-git-token-or-password
GIT_SSH_KEY_PATH=~/.ssh/id_rsa

# Git sync settings
GIT_AUTO_PUSH=true
GIT_AUTO_PULL=true
GIT_COMMIT_AUTHOR_NAME=AI Agent
GIT_COMMIT_AUTHOR_EMAIL=ai-agent@example.com

# Git sync scheduling
GIT_SYNC_ENABLED=true
GIT_SYNC_INTERVAL=3600
GIT_SYNC_ON_CONTENT_CHANGE=true

# Temporary file export settings
GIT_EXPORT_DIR=./data/git_export
GIT_CLEANUP_TEMP_FILES=true
GIT_EXPORT_FORMAT=markdown

# -----------------------------------------------------------------------------
# XML Prompting System Configuration
# -----------------------------------------------------------------------------
# XML prompt validation settings
XML_PROMPT_VALIDATION_ENABLED=true
XML_PROMPT_STRICT_MODE=false
XML_PROMPT_MAX_LENGTH=10000
XML_PROMPT_CACHE_TTL=3600

# Prompt versioning
XML_PROMPT_VERSIONING_ENABLED=true
XML_PROMPT_DEFAULT_VERSION=1.0
XML_PROMPT_A_B_TESTING=false

# Output validation
XML_OUTPUT_VALIDATION_ENABLED=true
XML_OUTPUT_RETRY_ON_INVALID=true
XML_OUTPUT_MAX_RETRIES=3

# -----------------------------------------------------------------------------
# Pipeline Execution Configuration
# -----------------------------------------------------------------------------
# Seven-phase pipeline settings
PIPELINE_ENABLED=true
PIPELINE_AUTO_START=false
PIPELINE_PAUSE_ON_ERROR=true
PIPELINE_MAX_CONCURRENT_PHASES=1

# Phase execution settings
PIPELINE_PHASE_TIMEOUT=3600
PIPELINE_PHASE_RETRY_COUNT=3
PIPELINE_PHASE_RETRY_DELAY=60

# Pipeline monitoring
PIPELINE_MONITORING_ENABLED=true
PIPELINE_PROGRESS_BROADCAST=true
PIPELINE_HISTORY_RETENTION_DAYS=30

# Sub-phase processing
SUBPHASE_PROCESSING_ENABLED=true
SUBPHASE_INTELLIGENT_SKIP=true
SUBPHASE_FORCE_REPROCESS=false
SUBPHASE_BATCH_SIZE=10

# -----------------------------------------------------------------------------
# Production Overrides
# -----------------------------------------------------------------------------
# These should be overridden in production environments

# Security (CRITICAL - MUST be changed in production)
# SECRET_KEY=your-production-secret-key-minimum-32-characters
# JWT_SECRET_KEY=your-production-jwt-secret-minimum-32-characters

# Database (production database connection)
# DATABASE_URL=postgresql+asyncpg://prod_user:secure_password@db-host:5432/aiagent_prod

# Redis (production Redis connection)
# REDIS_URL=redis://redis-host:6379

# HTTPS enforcement
# FORCE_HTTPS=true
# SESSION_COOKIE_SECURE=true

# CORS (restrict to production domains)
# ALLOWED_ORIGINS=["https://yourdomain.com"]

# Logging (production logging settings)
# LOG_LEVEL=WARNING
# LOG_TO_FILE=true
# DEBUG=false

# Performance (production performance settings)
# WORKERS=4
# DATABASE_POOL_SIZE=50
# REDIS_MAX_CONNECTIONS=100